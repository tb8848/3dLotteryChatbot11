<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>套餐快选日志</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="../css/basicSetting.css" media="all">
    <link rel="stylesheet" href="../js/layui/css/layui.css" media="all">

    <link href="../css/style-Permutation5.css?v=20221212172846000" type="text/css" rel="stylesheet">
    <link href="../css/A-P5.css?v=20221212172846000" type="text/css" rel="stylesheet">
    <style>
        th {
            background: url(../img/bg-thead.gif) repeat-x left top;
            color: #fff;
            font-weight: bold;
            border-bottom: 1px solid #a4d4f9;
            border-right: 1px solid #a4d4f9;
            padding: 0 4px;
        }

        td {
            border: 1px solid #a4d4f9 !important;
            border-width: 0 1px 1px 0;
            padding: 4px;
            outline: none;
        }
        .layui-table, .layui-table-view {
            margin: 0px 0;
        }
        .layui-table-header {
            height: 30px;
        }

        .layui-table thead tr th{
            font-weight: bold !important;
        }

        .layui-table tbody tr td{
            color: black;
        }

        .layui-table-cell{
            font-size: 12px;
        }
    </style>
</head>
<body style="font: 12px Arial, Helvetica, sans-serif;overflow-y: auto">
<div id="main" >
    <div class="module">
        <div name="module" id="log_odds_kuaixuan" class="m5 mt10">
            <div name="module" id="guide_log_odds" class="guide">
                <div class="fl">
                    <a href="#!online_account" i18n="log.top.position">位置 </a>&gt;&gt;
                    <span class="red" i18n="log.top.package.select">   套餐快选日志  </span>
                </div>
                <div class="fr">
                    <a href="dingpanLog.html" class="" i18n="log.top.fixed.plate">定盘日志</a> |
                    <!--<a href="baopaiLog.html" class="" i18n="log.top.package">包牌日志</a> |-->
                    <a href="peilvBiandongLog.html" class="" i18n="log.top.odds.change">赔率变动日志</a> |
                    <a href="taoCanLog.html" class="fb red" i18n="log.top.package.select">套餐快选日志</a> |
                    <a href="fepiPeilvLog.html" class="" i18n="log.top.batch.odds">分批赔率日志</a> |
                    <a href="huiyuanLog.html" class="" i18n="log.top.member.select">会员快选日志</a></div>
            </div>
            <div class="mt10">
                <form novalidate="novalidate">
                    <table class="t-1">
                        <thead>
                        <tr class="bg1">
                            <td colspan="8" i18n="log.top.package.select">套餐快选日志</td>
                        </tr>
                        </thead>
                        <tbody>
                        <tr id="search">
                            <td width="60" align="right">{{$t('issue')}}</td>
                            <td width="60">
                                <select name="periodno" id="sel_period_no">
                                    <option value="">{{$t('all')}}</option>
                                </select>
                            </td>
                            <td width="60">{{$t('type')}}</td>
                            <td width="60">
                                <select name="fix_num" id="fix_num">
                                    <option value="">{{$t('all')}}</option>
                                    <option value="-1">直选</option>
                                    <option value="19">&nbsp;&nbsp;普通</option>
                                    <option value="20">&nbsp;&nbsp;和值</option>
                                    <option value="-2">组三</option>
                                    <option value="21">&nbsp;&nbsp;普通</option>
                                    <option value="22">&nbsp;&nbsp;胆拖</option>
                                    <option value="23">&nbsp;&nbsp;和值</option>
                                    <option value="-3">组六</option>
                                    <option value="24">&nbsp;&nbsp;普通</option>
                                    <option value="25">&nbsp;&nbsp;胆拖</option>
                                    <option value="26">&nbsp;&nbsp;和值</option>
                                    <option value="-4">1D</option>
                                    <option value="13">&nbsp;&nbsp;1D</option>
                                    <option value="14">&nbsp;&nbsp;猜1D</option>
                                    <option value="-5">2D</option>
                                    <option value="15">&nbsp;&nbsp;2D</option>
                                    <option value="16">&nbsp;&nbsp;猜2D</option>
                                    <option value="-6">包选</option>
                                    <option value="17">&nbsp;&nbsp;包选三</option>
                                    <option value="18">&nbsp;&nbsp;包选六</option>
                                    <option value="-7">和数</option>
                                    <option value="27">&nbsp;&nbsp;0/27</option>
                                    <option value="28">&nbsp;&nbsp;1/26</option>
                                    <option value="29">&nbsp;&nbsp;2/25</option>
                                    <option value="30">&nbsp;&nbsp;3/24</option>
                                    <option value="31">&nbsp;&nbsp;4/23</option>
                                    <option value="32">&nbsp;&nbsp;5/22</option>
                                    <option value="33">&nbsp;&nbsp;6/21</option>
                                    <option value="34">&nbsp;&nbsp;7/20</option>
                                    <option value="35">&nbsp;&nbsp;8/19</option>
                                    <option value="36">&nbsp;&nbsp;9/18</option>
                                    <option value="37">&nbsp;&nbsp;10/17</option>
                                    <option value="38">&nbsp;&nbsp;11/16</option>
                                    <option value="39">&nbsp;&nbsp;12/15</option>
                                    <option value="40">&nbsp;&nbsp;13/14</option>
                                    <option value="2">复式</option>
                                    <option value="9">大小</option>
                                    <option value="10">奇偶</option>
                                    <option value="11">猜三同</option>
                                    <option value="12">拖拉机</option>
                                </select>
                            </td>
                            <td>
                                <button type="submit" lay-submit lay-filter="search" class="btn">{{$t('submit')}}</button>
<!--                                <input type="submit" value="提交" lay-submit lay-filter="search" class="btn" i18n="log.table.submit">-->
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </form>
            </div>
            <div class="mt10" style="border: 1px solid #000000">
                <table class="layui-hide" id="t" lay-filter="t" ></table>
            </div>
        </div>
    </div>
</div>
<script src="../js/jquery/jquery.min.js"></script>
<script src="../js/layui/layui.js"></script>
<script src="../js/layui/layui.all.js"></script>
<script src="../js/token.js"></script>
<script src="../js/config.js"></script>
<script src="../js/vue/vue.js"></script>
<script src="../js/vue/vue-i18n.js"></script>
<script src="../js/jquery.i18n.min.js"></script>
<script src="../js/multi_lang_config.js"></script>
<script  type="text/javascript" language="javascript">
    //window.parent.document.getElementsByClassName("layui-body")[0].style.top = "45px";

    const messages = {
        zh: {
            all:"全部",
            type:"类型",
            issue:"期数",
            submit:"提交",
        },
        th: {
            all:"ทั้งหมด",
            type:"ประเภท",
            issue:"หมายเลขงวด",
            submit:"ส่ง",
        }
    }

    var layer = layui.layer;
    var form = layui.form;
    var table = layui.table;
    var $ = layui.jquery;

    var moduleName = "log";
    var defaultLang = layui.data('langTab').langType;
    const i18n = new VueI18n({
        locale: defaultLang, // set locale
        messages, // set locale messages
    });
    initLangConfig({
        defaultLang:defaultLang,
        filePath: "../js/i18n/"+moduleName+"/",
        module:moduleName,
        base:"../js/"
    })
    var i18np = null;
    function changeLang(lang) {
        defaultLang = lang;
        reloadI18n({
            defaultLang:lang,
            filePath: "../js/i18n/"+moduleName+"/",
            module:moduleName,
        })
        i18np.loadProperties(moduleName);
        i18n.locale=lang;

        // getBettingMethod();

        // layui刷新表头
        table.reload("tt",{
            cols: [
                [
                    {field: 'drawId',title: i18np.prop('log.table.issue.number'), width: 105},
                    {field: 'userName',title: i18np.prop('log.table.operation.account'), width: 125},
                    {field: 'buyAmount',title: i18np.prop('log.table.bishu'), width: 110},
                    {field: 'odds',title: i18np.prop('log.table.odds'),width: 100},
                    {field: 'topLimit',title: i18np.prop('log.table.limit'),width: 110},
                    {field: 'content',title: i18np.prop('log.table.operation.content')+' <span style="color: #ffff00">('+i18np.prop('log.table.title.msg')+')</span>',templet:function (d) {
                        var content = defaultLang=="zh"?d.content:d.contentTh;
                        if (content==null || content=="" || content==undefined){
                            return "";
                        }
                        return content;
                        }},
                    {field: 'ip',title: i18np.prop('log.table.operation.ip'),width: 145,templet:function (d) {
                            var ip = d.ip;
                            if (ip!=null && ip!="" && ip!=undefined){
                                var x = ip.indexOf(".",ip.indexOf(".")+1);
                                return ip.substring(0,x)+".*.*"
                            }
                            return ""
                        }},
                    {field: 'operationTime',title: i18np.prop('log.table.operation.time'),width: 150},
                    {field: 'contentJson',title: i18np.prop('log.table.regenerate'),align: 'center',width: 100,templet:function (d) {
                            return "<button type=\"button\" class=\"fn_recur btn\" style='cursor: pointer' onclick='shengcheng("+d.contentJson+")'>" +
                                i18np.prop('log.table.generate') +
                                "</button>"
                        }},
                    {field: '',title: '<button type="button" class="fn_top btn" style="cursor: pointer" onclick="changyong()">'+i18np.prop('log.table.common.use')+'</button>',align: 'center',width: 80
                        ,templet:function (d) {
                            if (d.common == 1){
                                checkBoxArr.push(d.id);
                                return "<input type=\"checkbox\" lay-skin=\"primary\" value='"+d.id+"' checked lay-filter='checkboxs'>"
                            }
                            return "<input type=\"checkbox\" lay-skin=\"primary\" value='"+d.id+"' lay-filter='checkboxs'>"
                        }},
                ]
            ],
            text:{none: i18np.prop('user.table.noData')},
        })
    }

    const vm = new Vue({
        el: '#search',
        i18n,
        data: {},
        methods: {
            init() {
                console.log("初始化vue了")
            }
        }
    })

    layui.config({base: '../js/'})
        // 继承treetable.js插件
        .extend({i18np: 'i18n'}).use([ 'i18np', 'form' , 'jquery','table'], function() {

        i18np = layui.i18np;
        i18np.loadProperties(moduleName);
        vm.init();
        // getBettingMethod();

        table.render({
            elem: '#t',
            id: 'tt',
            url: HOST+'packageLog/selectPackageLogPage',
            limit: 40,
            cols: [
                [
                    {field: 'drawId',title: i18np.prop('log.table.issue.number'), width: 105},
                    {field: 'userName',title: i18np.prop('log.table.operation.account'), width: 125},
                    {field: 'buyAmount',title: i18np.prop('log.table.bishu'), width: 110},
                    {field: 'odds',title: i18np.prop('log.table.odds'),width: 100},
                    {field: 'topLimit',title: i18np.prop('log.table.limit'),width: 110},
                    {field: 'content',title: i18np.prop('log.table.operation.content')+' <span style="color: #ffff00">('+i18np.prop('log.table.title.msg')+')</span>',templet:function (d) {
                            var content = defaultLang=="zh"?d.content:d.contentTh;
                            if (content==null || content=="" || content==undefined){
                                return "";
                            }
                            return content;
                        }},
                    {field: 'ip',title: i18np.prop('log.table.operation.ip'),width: 145,templet:function (d) {
                            var ip = d.ip;
                            if (ip!=null && ip!="" && ip!=undefined){
                                var x = ip.indexOf(".",ip.indexOf(".")+1);
                                return ip.substring(0,x)+".*.*"
                            }
                            return ""
                        }},
                    {field: 'operationTime',title: i18np.prop('log.table.operation.time'),width: 150},
                    {field: 'contentJson',title: i18np.prop('log.table.regenerate'),align: 'center',width: 100,templet:function (d) {
                            return "<button type=\"button\" class=\"fn_recur btn\" style='cursor: pointer' onclick='shengcheng("+d.contentJson+")'>" +
                                i18np.prop('log.table.generate') +
                                "</button>"
                        }},
                    {field: '',title: '<button type="button" class="fn_top btn" style="cursor: pointer" onclick="changyong()">'+i18np.prop('log.table.common.use')+'</button>',align: 'center',width: 80
                        ,templet:function (d) {
                            if (d.common == 1){
                                checkBoxArr.push(d.id);
                                return "<input type=\"checkbox\" lay-skin=\"primary\" value='"+d.id+"' checked lay-filter='checkboxs'>"
                            }
                            return "<input type=\"checkbox\" lay-skin=\"primary\" value='"+d.id+"' lay-filter='checkboxs'>"
                        }},
                ]
            ],
            page: true
            ,page: {
                curr: layui.data("t_page").index
            },
            text:{none: i18np.prop('user.table.noData')},
            done: (res, curr, count) => {
                form.render();
                layui.data("t_page", {
                    key: 'index',
                    value: curr
                });
            }
        });
    })

    //选中集合
    var checkBoxArr = new Array();
    //取消选中集合
    var disCheckBoxArr = new Array();

    //复选框监听
    form.on('checkbox(checkboxs)', function(data){
        //选中状态下改变按钮为可点击状态
        if(data.elem.checked){
            $('#del').removeClass('layui-btn-disabled');
            checkBoxArr.push(data.elem.value);
            $.each(disCheckBoxArr,function(i,a){
                if(a == data.elem.value){
                    disCheckBoxArr.splice(i,1);
                }
            });
        }else if(!data.elem.checked){
            //取消选中时检查是否还有其他复选框被选中，所有复选框都没选中状态则改变按钮为禁用状态
            $.each(checkBoxArr,function(i,a){
                if(a == data.elem.value){
                    disCheckBoxArr.push(a);
                    checkBoxArr.splice(i,1);
                }
            });
            if(checkBoxArr.length < 1){
                $('#del').addClass('layui-btn-disabled');
            }
        }
        // console.log(checkBoxArr);
        // console.log(disCheckBoxArr);
        // console.log(data.elem); //得到checkbox原始DOM对象
        // console.log(data.elem.checked); //是否被选中，true或者false
        // console.log(data.value); //复选框value值，也可以通过data.elem.value得到
        // console.log(data.othis); //得到美化后的DOM对象
    });

    //获取彩票玩法列表
    // function getBettingMethod(){
    //     $.ajax({
    //         url:HOST+"lotteryMethod/selectListLotteryMethod" ,
    //         success:function(res){
    //             if(res.code == 0) {
    //                 $("#fix_num").html("");
    //                 $("#fix_num").append("<option value=''>"+i18np.prop('log.table.all')+"</option>");
    //                 if (defaultLang=="zh"){
    //                     for(var i in res.data) {
    //                         $("#fix_num").append("<option value='"+res.data[i].id+"'>"+res.data[i].bettingMethod+"</option>");
    //                     }
    //                 }else{
    //                     for(var i in res.data) {
    //                         $("#fix_num").append("<option value='"+res.data[i].id+"'>"+res.data[i].bettingMethodTh+"</option>");
    //                     }
    //                 }
    //                 form.render()
    //             }
    //         }
    //     });
    // }

    //获取期数
    $.ajax({
        url:HOST+"draw/getDrawList68" ,
        success:function(res){
            if(res.code == 200) {
                for(var i in res.data) {
                    $("#sel_period_no").append("<option value='"+res.data[i].drawId+"'>"+res.data[i].drawId+"</option>")
                }
                form.render()
            }
        }
    });

    // 搜索查询
    form.on('submit(search)',function(data){
        drawId = $("#sel_period_no").val();
        lotteryMethodId = $("#fix_num").val();
        table.reload('tt', {
            where: {"drawId":drawId,"lotteryMethodId":lotteryMethodId}
            , page: {
                curr: 1
            }
        });
        return false;
    });

    //生成
    function shengcheng(contentJson){
        window.location.href = "../setting/quickSelect.html?source=1&contentJson="+JSON.stringify(contentJson)
    }

    //常用
    function changyong() {
        // console.log("点击常用了")
        // console.log(checkBoxArr);
        if (checkBoxArr.length == 0){
            layer.msg(i18np.prop('log.api.noSelect'));
            return false;
        }
        $.ajax({
            url:HOST+"packageLog/setPackageLogCommon" ,
            type:'post',
            contentType:'application/json',
            data:JSON.stringify({
                checkBoxArr:checkBoxArr,
                disCheckBoxArr:disCheckBoxArr
            }),
            success:function(res){
                if(res.code == 200) {
                    // layer.msg("设置成功");
                    layer.msg(i18np.prop('log.api.set.success'));
                    checkBoxArr = [];
                    disCheckBoxArr = [];
                    table.reload('tt');
                }else if(res.code == 500){
                    layer.msg(i18np.prop('log.api.noSelect'));
                }else{
                    layer.msg(i18np.prop('log.api.set.fail'));
                }
            }
        });
    }

</script>
</body>
</html>